"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault")["default"];

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = void 0;

var _parse = _interopRequireDefault(require("date-fns/parse"));

var _isValid = _interopRequireDefault(require("date-fns/isValid"));

var _locales = _interopRequireDefault(require("../locales"));

var parseDate = function parseDate(date, locale) {
  var referenceDate = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : new Date();
  var match = date.match(/(.)(\d{1,4})$/);
  var isSetFullYear = false;

  if (match) {
    var separator = match[1];
    var year = match[2];
    isSetFullYear = !!separator && date.split(separator).length === 3 && year.length === 3;
  }

  var dateStrWithFullYear = isSetFullYear ? "".concat(date, "0") : date;
  var _locales$locale = _locales["default"][locale],
      formats = _locales$locale.formats,
      dateFnsLocale = _locales$locale.dateFnsLocale;

  for (var i = 0, l = formats.length; i < l; ++i) {
    var format = formats[i];
    var parsed = (0, _parse["default"])(dateStrWithFullYear, format, referenceDate, {
      locale: dateFnsLocale
    });

    if ((0, _isValid["default"])(parsed)) {
      return parsed;
    }
  }

  return null;
};

var _default = parseDate;
exports["default"] = _default;